.main-blog.page-width {
  max-width: 900px;
  margin-left: auto;
  margin-right: auto;
}

/* Flip journal should use the full available viewport width (until mobile rules kick in) */
.main-blog.page-width.main-blog--flip {
  max-width: 100%;

  /* Override Dawn's wider page padding so the book can breathe on large screens */
  padding-left: clamp(1.2rem, 3vw, 6rem);
  padding-right: clamp(1.2rem, 3vw, 6rem);
}

.blog-articles {
  display: grid;
  grid-gap: 1rem;
  column-gap: var(--grid-mobile-horizontal-spacing);
  row-gap: var(--grid-mobile-vertical-spacing);
}

.blog-articles .card-wrapper {
  width: 100%;
}

@media screen and (min-width: 750px) {
  .blog-articles {
    grid-template-columns: 1fr 1fr;
    column-gap: var(--grid-desktop-horizontal-spacing);
    row-gap: var(--grid-desktop-vertical-spacing);
  }

  .blog-articles--collage > *:nth-child(3n + 1),
  .blog-articles--collage > *:nth-child(3n + 2):last-child {
    grid-column: span 2;
    text-align: center;
  }

  .blog-articles--collage > *:nth-child(3n + 1) .card,
  .blog-articles--collage > *:nth-child(3n + 2):last-child .card {
    text-align: center;
  }

  .blog-articles--collage > *:nth-child(3n + 1) .article-card__image--small .ratio::before,
  .blog-articles--collage > *:nth-child(3n + 2):last-child .article-card__image--small .ratio::before {
    padding-bottom: 22rem;
  }

  .blog-articles--collage > *:nth-child(3n + 1) .article-card__image--medium .ratio::before,
  .blog-articles--collage > *:nth-child(3n + 2):last-child .article-card__image--medium .ratio::before {
    padding-bottom: 44rem;
  }

  .blog-articles--collage > *:nth-child(3n + 1) .article-card__image--large .ratio::before,
  .blog-articles--collage > *:nth-child(3n + 2):last-child .article-card__image--large .ratio::before {
    padding-bottom: 66rem;
  }
}

@media screen and (min-width: 990px) {
  .blog-articles--collage > *:nth-child(3n + 1) .article-card__image--small .ratio .ratio::before,
  .blog-articles--collage > *:nth-child(3n + 2):last-child .article-card__image--small .ratio .ratio::before {
    padding-bottom: 27.5rem;
  }

  .blog-articles--collage > *:nth-child(3n + 1) .article-card__image--medium .ratio::before,
  .blog-articles--collage > *:nth-child(3n + 2):last-child .article-card__image--medium .ratio::before {
    padding-bottom: 55rem;
  }

  .blog-articles--collage > *:nth-child(3n + 1) .article-card__image--large .ratio::before,
  .blog-articles--collage > *:nth-child(3n + 2):last-child .article-card__image--large .ratio::before {
    padding-bottom: 82.5rem;
  }
}

/*
  Flip journal layout (main blog)
  Goal: make the layout feel like an open book
  - Desktop: two pages with a visible spine + outer "cover" margin
  - Mobile: one page focus, with a page-turn within each spread every other click
*/

.blog-flip {
  /* Overall book size (fill the container responsively) */
  --blog-flip-width: 100%;

  /* Pages + center seam */
  --blog-flip-page-width: minmax(0, 1fr);
  --blog-flip-seam-width: 0.3rem;

  /* "Cover" margin around the open pages (reduced further) */
  --blog-flip-cover-pad: clamp(0.8rem, 1.1vw, 1.6rem);
  --blog-flip-cover-radius: 1.6rem;

  /* Cover colors (brand warm neutrals) */
  --blog-flip-cover-base: #b1a785;
  --blog-flip-cover-deep: #817c69;

  /* Paper styling */
  --blog-flip-paper-color: #f7f3ee; /* ivory / paper */
  --blog-flip-paper-pad: 1.4rem;
  --blog-flip-inner-pad: 2.4rem;
  --blog-flip-rule-gap: 3.2rem;
  --blog-flip-paper-radius: 1.0rem;

  /* Fixed book height so the layout doesn't jump between spreads */
  --blog-flip-book-height: clamp(56rem, 72vh, 78rem);

  max-width: var(--blog-flip-width);
  margin: 0 auto;
  position: relative;
  padding: var(--blog-flip-cover-pad);
  border-radius: var(--blog-flip-cover-radius);

  /* Warm "cover" frame + gentle depth (lighter than before) */
  background-color: var(--blog-flip-cover-base);
  background: linear-gradient(135deg, #c8c0a3, var(--blog-flip-cover-base));
  border-color: var(--blog-flip-cover-deep);
  border: 0.1rem solid var(--blog-flip-cover-deep);
  box-shadow:
    0 1.4rem 3.2rem rgba(0, 0, 0, 0.10),
    inset 0 0 0 0.1rem rgba(255, 255, 255, 0.20);
}

/* Fine grain texture over the cover */
.blog-flip:before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: var(--blog-flip-cover-radius);
  background-image: repeating-linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.18) 0,
    rgba(255, 255, 255, 0.18) 1px,
    transparent 1px,
    transparent 6px
  );
  opacity: 0.35;
  pointer-events: none;
}

.blog-flip__spread {
  width: 100%;
  display: none;
  grid-template-columns: var(--blog-flip-page-width) var(--blog-flip-page-width);
  column-gap: 0;
  justify-content: center;
  align-items: stretch;
  position: relative;
  z-index: 1; /* above cover texture */

  /* Keep spreads a consistent height so page turning doesn't shift layout */
  min-height: var(--blog-flip-book-height);
}

.blog-flip:not(.is-initialized) .blog-flip__spread:last-child {
  display: grid;
}

.blog-flip__spread.is-active {
  display: grid;
}

/* Thin page seam (like a book gutter) */
.blog-flip__spread:before {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  left: 50%;
  width: var(--blog-flip-seam-width);
  transform: translateX(-50%);

  /* A slightly warm seam so it feels like paper shadows, not a divider bar */
  background: linear-gradient(
    to right,
    rgba(0, 0, 0, 0.08),
    rgba(0, 0, 0, 0.02),
    rgba(0, 0, 0, 0.08)
  );

  /* Soft depth between pages */
  box-shadow:
    0 0 1.4rem rgba(0, 0, 0, 0.18),
    inset 0 0 0 0.1rem rgba(0, 0, 0, 0.06);

  border-radius: 1rem;
  pointer-events: none;
}

.blog-flip__page {
  min-width: 0;
}

.blog-flip__paper {
  position: relative;
  height: 100%;
  padding: var(--blog-flip-paper-pad);
  border: 0.1rem solid rgba(var(--color-foreground), 0.10);
  background-color: var(--blog-flip-paper-color);
  overflow: hidden;

  /* Slight vignette at outer edges to mimic stacked pages */
  background-image:
    radial-gradient(circle at left center, rgba(0, 0, 0, 0.06), transparent 48%),
    radial-gradient(circle at right center, rgba(0, 0, 0, 0.06), transparent 48%),
    repeating-linear-gradient(
      to bottom,
      rgba(var(--color-foreground), 0.05) 0,
      rgba(var(--color-foreground), 0.05) 0.1rem,
      transparent 0.1rem,
      transparent var(--blog-flip-rule-gap)
    );

  box-shadow: 0 0.8rem 2.2rem rgba(0, 0, 0, 0.08);
}

/* Paper corners (rounded only on the outer edges, like a book) */
.blog-flip__paper--left {
  border-radius: var(--blog-flip-paper-radius) 0 0 var(--blog-flip-paper-radius);
  box-shadow: -0.6rem 0.8rem 2.2rem rgba(0, 0, 0, 0.08);
}

.blog-flip__paper--right {
  border-radius: 0 var(--blog-flip-paper-radius) var(--blog-flip-paper-radius) 0;
  box-shadow: 0.6rem 0.8rem 2.2rem rgba(0, 0, 0, 0.08);
}

.blog-flip__paper--blank {
  background-image: none;
}

/* inner margins (towards spine) */
.blog-flip__paper--left {
  padding-right: var(--blog-flip-inner-pad);
}

.blog-flip__paper--right {
  padding-left: var(--blog-flip-inner-pad);
}

/* vertical margin line inside each page */
.blog-flip__paper--left:before,
.blog-flip__paper--right:before {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  width: 0.1rem;
  background: rgba(var(--color-foreground), 0.10);
}

.blog-flip__paper--left:before {
  right: calc(var(--blog-flip-inner-pad) - 1.8rem);
}

.blog-flip__paper--right:before {
  left: calc(var(--blog-flip-inner-pad) - 1.8rem);
}

/* Let the paper be the visual container */
.blog-flip .article {
  display: block;
}

/*
  Flip journal article-card layout tweaks
  - show image in a 2:3 frame (portrait) without cropping
  - place text in a column next to the image
  - mirror layout per page (left page: image left, right page: image right)
*/
.blog-flip .article-card.card--media .card__inner.ratio::before {
  content: none;
}

@media screen and (min-width: 750px) {
  /* The snippet renders a duplicate .card__content outside .card__inner;
     hide it so the in-inner content can sit in the grid next to the image. */
  .blog-flip .article-card > .card__content {
    display: none;
  }

  /*
    Two-column page layout inside each page:
    - Outside column: image
    - Inside column: text (closer to the center seam)
  */
  .blog-flip .article-card.card--media .card__inner {
    display: grid;
    grid-template-columns: minmax(0, 38%) minmax(0, 62%);
    grid-template-rows: auto;
    grid-auto-flow: column;
    column-gap: 2.2rem;
    align-items: start;
    align-content: start;
  }

  /* Mirror on the right page (text inside, image outside) */
  .blog-flip__page--right .article-card.card--media .card__inner {
    grid-template-columns: minmax(0, 62%) minmax(0, 38%);
  }

  /*
    Dawn sets .card__media to position:absolute;
    force it back into normal flow so the grid can lay out image + text.
  */
  .blog-flip .article-card__image-wrapper.card__media {
    position: relative !important;
    top: auto !important;
    right: auto !important;
    bottom: auto !important;
    left: auto !important;

    grid-row: 1;
    align-self: start;

    margin: 0;
    width: 100%;
    aspect-ratio: 2 / 3;
    overflow: hidden;
    border-radius: 0.8rem;
    background: var(--blog-flip-paper-color);

    /* slightly inset from outer edge so it doesn't feel glued to the border */
    padding: 0.2rem;
  }

  .blog-flip .card__content {
    grid-row: 1;
    padding: 0;
    align-self: start;
    margin-top: 0;
  }

  .blog-flip .card__information {
    align-self: start;
  }

  /*
    Dawn hides article text inside .card__inner for some card styles.
    In the flip journal we rely on the inner content (we hide the duplicate outer content),
    so we must force the title/meta/excerpt back on.
  */
  .blog-flip .article-card .card__inner .card__content,
  .blog-flip .article-card .card__inner .card__information {
    display: block !important;
  }

  /*
    Dawn global hover setting (animate--hover-3d-lift) rotates the whole .card__inner.
    For the flip journal we only want the image to have motion, not the full page.
  */
  .blog-flip .card-wrapper:hover .card--standard .card__inner,
  .blog-flip .card-wrapper:hover .card--card {
    transform: none !important;
    filter: none !important;
    box-shadow: none !important;
  }

  .blog-flip .card-wrapper:hover .card--standard .card__inner:after,
  .blog-flip .card-wrapper:hover .card--card:after,
  .blog-flip .card-wrapper:hover .card--standard .card__media:after,
  .blog-flip .card-wrapper:hover .card--card:before {
    content: none !important;
  }

  /* Apply a subtle tilt to the image only */
  .blog-flip .article-card__image-wrapper.card__media {
    transition: transform var(--duration-long) ease, box-shadow var(--duration-long) ease;
    transform-origin: center;
    will-change: transform;
  }

  .blog-flip__page--left .card-wrapper:hover .article-card__image-wrapper.card__media {
    transform: rotate(-1deg) translateY(-0.2rem);
    box-shadow: -0.6rem 1.2rem 2.4rem rgba(0, 0, 0, 0.12);
  }

  .blog-flip__page--right .card-wrapper:hover .article-card__image-wrapper.card__media {
    transform: rotate(1deg) translateY(-0.2rem);
    box-shadow: 0.6rem 1.2rem 2.4rem rgba(0, 0, 0, 0.12);
  }

  /* Left page ordering */
  .blog-flip__page--left .article-card__image-wrapper.card__media {
    grid-column: 1;
  }

  .blog-flip__page--left .card__content {
    grid-column: 2;
  }

  /* Right page ordering */
  .blog-flip__page--right .article-card__image-wrapper.card__media {
    grid-column: 2;
  }

  .blog-flip__page--right .card__content {
    grid-column: 1;
  }
}

/* Mobile: keep a simple vertical stack */
@media screen and (max-width: 749px) {
  .blog-flip .article-card > .card__content {
    display: none;
  }

  .blog-flip .article-card.card--media .card__inner {
    display: block;
  }

  .blog-flip .article-card__image-wrapper.card__media {
    position: relative !important;
    top: auto !important;
    right: auto !important;
    bottom: auto !important;
    left: auto !important;

    margin: 0 0 1.4rem 0;
    width: 100%;
    aspect-ratio: 2 / 3;
    overflow: hidden;
    border-radius: 0.8rem;
    background: var(--blog-flip-paper-color);
    padding: 0.2rem;
  }
}

.blog-flip .article-card__image.media {
  position: absolute;
  inset: 0;
  padding-bottom: 0 !important;
}

.blog-flip .article-card__image img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* Increase text sizes inside the pages */
.blog-flip .card__heading {
  font-size: clamp(2.2rem, 1.6vw, 2.8rem);
  line-height: 1.15;
}

.blog-flip .article-card__info {
  font-size: 1.25rem;
}

.blog-flip .article-card__excerpt {
  font-size: 1.6rem;
  line-height: 1.7;

  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 5;
  overflow: hidden;
}

.blog-flip .article-card-wrapper {
  width: 100%;
}

.blog-flip .card.article-card {
  background: transparent;
  border: none;
  box-shadow: none;
}

/* Ensure no inner card shells paint white backgrounds over the "paper" */
.blog-flip .article-card .card__inner,
.blog-flip .article-card .card__content,
.blog-flip .article-card .card__information {
  background: transparent;
}

.blog-flip .article-card .card__information {
  padding-left: 0;
  padding-right: 0;
}

.blog-flip .article-card__image-wrapper {
  border-radius: 0;
  overflow: hidden;
}

.blog-flip__controls {
  margin-top: 2rem;
  display: flex;
  justify-content: space-between;
  gap: 1.2rem;
}

.blog-flip__button {
  appearance: none;
  background: transparent;
  border: none;
  padding: 0;
  font: inherit;
  color: #8A9BB7;
  cursor: pointer;
  text-decoration: underline;
  text-underline-offset: 0.3rem;
}

.blog-flip__button:hover {
  text-decoration-thickness: 0.2rem;
}

.blog-flip__button[disabled] {
  opacity: 0.4;
  cursor: not-allowed;
  text-decoration: none;
}

@media screen and (min-width: 750px) {
  /* Reserve space so bottom-corner controls don't overlap content */
  .blog-flip__paper {
    padding-bottom: calc(var(--blog-flip-paper-pad) + 3.2rem);
  }

  /* Only one control per page on desktop (prev on left, next on right) */
  .blog-flip__page--left [data-blog-flip-next] {
    display: none;
  }

  .blog-flip__page--right [data-blog-flip-prev] {
    display: none;
  }

  /* Pin controls to the bottom corners */
  .blog-flip__controls {
    position: absolute;
    bottom: 1.6rem;
    left: 1.6rem;
    right: 1.6rem;
    margin-top: 0;
    justify-content: space-between;
    pointer-events: none; /* allow clicks only on the buttons */
  }

  .blog-flip__button {
    pointer-events: auto;
  }

  .blog-flip__page--left .blog-flip__controls {
    right: auto;
  }

  .blog-flip__page--right .blog-flip__controls {
    left: auto;
  }
}

/* Desktop animations when moving between spreads */
@media screen and (min-width: 750px) {
  .blog-flip__spread {
    perspective: 1600px;
  }

  .blog-flip__page--right {
    transform-origin: left center;
    transform-style: preserve-3d;
    backface-visibility: hidden;
  }

  .blog-flip__page--left {
    transform-origin: right center;
    transform-style: preserve-3d;
    backface-visibility: hidden;
  }

  /*
    Required direction:
    - Desktop Previous (older): LEFT page flips to the right
    - Desktop Next (newer): RIGHT page flips to the left
  */
  .blog-flip__spread.is-turning-prev .blog-flip__page--left {
    z-index: 3;
    animation: blog-flip-turn-next 420ms cubic-bezier(0.2, 0.8, 0.2, 1) both;
  }

  .blog-flip__spread.is-turning-next .blog-flip__page--right {
    z-index: 3;
    animation: blog-flip-turn-prev 420ms cubic-bezier(0.2, 0.8, 0.2, 1) both;
  }

  @keyframes blog-flip-turn-prev {
    0% {
      transform: rotateY(0deg);
    }
    100% {
      transform: rotateY(-160deg);
    }
  }

  @keyframes blog-flip-turn-next {
    0% {
      transform: rotateY(0deg);
    }
    100% {
      transform: rotateY(160deg);
    }
  }
}

/* Mobile: one page focus + within-spread flip */
@media screen and (max-width: 749px) {
  .blog-flip {
    --blog-flip-width: 100%;
    --blog-flip-page-width: 100%;
    --blog-flip-seam-width: 0px;

    /* Slightly shorter on mobile to reduce scroll while keeping stable height */
    --blog-flip-book-height: clamp(54rem, 70vh, 72rem);
  }

  .blog-flip__spread {
    grid-template-columns: 1fr;
    column-gap: 0;
    min-height: var(--blog-flip-book-height);
  }

  .blog-flip__spread:before {
    display: none;
  }

  .blog-flip__page {
    grid-column: 1;
    grid-row: 1;
  }

  /* Pin controls to bottom corners on the visible page */
  .blog-flip__paper {
    padding-bottom: calc(var(--blog-flip-paper-pad) + 3.2rem);
  }

  .blog-flip__controls {
    position: absolute;
    bottom: 1.6rem;
    left: 1.6rem;
    right: 1.6rem;
    margin-top: 0;
    pointer-events: none;
  }

  .blog-flip__button {
    pointer-events: auto;
  }

  /* Only show controls for the page that's currently visible */
  .blog-flip__page--left .blog-flip__controls {
    opacity: 0;
  }

  .blog-flip__page--right .blog-flip__controls {
    opacity: 1;
  }

  .blog-flip__spread.is-showing-left .blog-flip__page--left .blog-flip__controls {
    opacity: 1;
  }

  .blog-flip__spread.is-showing-left .blog-flip__page--right .blog-flip__controls {
    opacity: 0;
  }

  .blog-flip__page--left {
    z-index: 1;
  }

  .blog-flip__page--right {
    z-index: 2;
    transform-origin: left center;
    transform-style: preserve-3d;
    backface-visibility: hidden;
    transition: transform 420ms cubic-bezier(0.2, 0.8, 0.2, 1);
  }

  .blog-flip__spread.is-showing-left .blog-flip__page--right {
    transform: rotateY(-180deg);
  }
}
